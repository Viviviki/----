# Аренда автомобилей

## Описание проекта и его функционал
Данный проект - это API-сервер для аренды автомобилей (вариант 7), созданный на Python с применением FastAPI. Он позволяет управлять афишей, расписанием сеансов, продажей билетов и отзывами, предоставляя удобный и эффективный интерфейс для взаимодействия.

Функционал проекта:

Автомобиль:

- Вывод всех автомобилей с возможностью их фильтрации и пагинации
    
- Вывод сведений об одном автомобиле
    
- Добавление новых автомобилей
    
- Редактирование существующих автомобилей
    
- Удаление автомобилей
    

Аренда:

- Вывод всех аренд
    
- Вывод сведений об одной аренде
    
- Добавление новых аренд
    
- Редактирование существующих аренд
    
- Удаление аренд
    

Отзыв:

- Получение всех пользовательских отзывов
    
- Получение сведений об одном отзыве
    
- Создание отзывов к автомобилю
    
- Редактирование отзывов
    
- Удаление отзывов
    

## Технологии

Проект построен на базе веб-фреймворка **FastAPI** версии 0.113.0. Для реализации функционала использованы следующие библиотеки:

- sqlalchemy 2.0.41
    
- pydantic-settings 2.9.1
    
- pymysql 1.1.1
    
- cryptography 45.0.3
    
- passlib 1.7.4
    
- PyJWT 2.10.1
    
- bcrypt 4.3.0
    

## Инструкции к запуску

Для запуска проекта выполните следующие шаги:
1. Создание виртуального окружения (.venv) `python -m venv .venv`
    
2. Активация виртуального окружения `.venv\Scripts\activate`
        
3. Установка зависимостей `pip install -r requirements.txt`
    
4. Запуск посева данных (seeding) `python seed.py`
    
5. Запуск приложения `fastapi dev main.py`
    

## Описание к API

- Методология: RESTful API
    
- Способ передачи данных: через URL-параметры и/или в теле запроса
    
- Документация: доступна по адресу `http://127.0.0.1/docs`

| Маршрут            | Метод | Параметры/Тело запроса      | Валидация                                                                                                                               | Аутентификация/Авторизация                                            |
|---------------------|-------|------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
| `/login`            | POST  | `LoginUser`:                 | `username`: min_length=2, max_length=20; `password`: min_length=8, max_length=20, regex                                     | Не требуется                                                        |
| `/api/cars`         | GET   | `page`: int = 1, `limit`: int <= 100, `type`: str, `minPrice_per_day`: float              | `limit` <= 100; `type` проверяется на наличие в БД                                                              | Требуется (auth_wrapper)                                                |
| `/api/car/{id}`     | GET   | `id`: int                     | `id` проверяется на наличие в БД                                                                                                       | Требуется (auth_wrapper)                                               |
| `/api/car`          | POST  | `CreateCar`:                 | Данные проверяются на соответствие типам и наличию связанных объектов в БД (mark_id, model_id, type_id, status_id)                                                             | Требуется (manager_wrapper)                                               |
| `/api/car/{id}`     | PUT   | `id`: int, `CreateCar`:                 | `id` проверяется на наличие в БД; Данные в `CreateCar` проверяются на соответствие типам и наличие связанных объектов в БД (mark_id, model_id, type_id, status_id)  | Требуется (manager_wrapper)                                           |
| `/api/car/{id}`     | DELETE| `id`: int                     | `id` проверяется на наличие в БД                                                                                                       | Требуется (manager_wrapper)                                               |
| `/api/rents`        | GET   |                                  |                                                                                                                                           | Требуется (auth_wrapper)                                                |
| `/api/rent/{id}`    | GET   | `id`: int                     | `id` проверяется на наличие в БД                                                                                                       | Требуется (auth_wrapper)                                               |
| `/api/rent`         | POST  | `CreateRent`:                | Данные проверяются на соответствие типам, `user_id` проверяется на наличие в БД                                                                              | Требуется (auth_wrapper)                                                |
| `/api/rent/{id}`    | PUT   | `id`: int, `CreateRent`:                | `id` проверяется на наличие в БД; Данные в `CreateRent` проверяются на соответствие типам, `user_id` проверяется на наличие в БД                         | Требуется (manager_wrapper)                                           |
| `/api/rent/{id}`    | DELETE| `id`: int                     | `id` проверяется на наличие в БД                                                                                                       | Требуется (manager_wrapper)                                               |
| `/api/user`         | POST  | `CreateUser`:                | `firstname`, `lastname`: min_length=2; `username`: min_length=2, max_length=20; `password`: regex     | Требуется (admin_wrapper)                                                |
| `/api/user/{id}`    | PUT   | `id`: int, `CreateUser`:                | `id` проверяется на наличие в БД; `firstname`, `lastname`: min_length=2; `username`: min_length=2, max_length=20; `password`: regex     | Требуется (admin_wrapper)                                           |
| `/api/user/{id}`    | DELETE| `id`: int                     | `id` проверяется на наличие в БД                                                                                                       | Требуется (admin_wrapper)                                               |
| `/api/reviews`      | GET   |                                  |                                                                                                                                           | Требуется (auth_wrapper)                                                |
| `/api/review/{id}`   | GET   | `id`: int                     | `id` проверяется на наличие в БД                                                                                                       | Требуется (auth_wrapper)                                               |
| `/api/review`       | POST  | `CreateReview`:              | `rating`: ge=0, le=5; Проверка, что пользователь не оставлял отзыв ранее на эту машину; Проверка, что `user_id` соответствует текущему пользователю | Требуется (auth_wrapper)                                                |
| `/api/review/{id}`   | PUT   | `id`: int, `CreateReview`:              | Проверка, что `user_id` в запросе соответствует текущему пользователю; `id` и `user_id` проверяются на наличие в БД; `rating`: ge=0, le=5 | Требуется (auth_wrapper)                                           |
| `/api/review/{id}`   | DELETE| `id`: int                     | `id` проверяется на наличие в БД                                                                                                       | Требуется (auth_wrapper)                                               |


## Описание ролей
В целях безопасности, в проекте реализовано управление доступом на основе ролей. Неавторизованные пользователи имеют доступ только к просмотру данных. Предусмотрены следующие роли:

- Клиент (username: Petya, password: zD*F64%3)
    
- Менеджер (username: Egor, password: P*VJ0Z&f)
    
- Админ (username: Petya007, password: %8hC5A*Y)
    
Возможности клиента:

- Просмотр автомобилей

- Аренда автомобилей

- Добавлять отзывы к автомобилям
    
- Изменять свои отзывы к автомобилям
    
- Удалять свои отзывы

Возможности Менеджера:

- Создавать запись об автомобиле

- Изменить запись об автомобиле

- Удалить запись об автомобиле

- Создавать аренду

- Изменить аренду

- Удалить аренду

Возможности админов:

- Полный доступ

## Контакты
Свяжитесь с нами:

- Телефон: 89221766138
    
- Почта: novii.comp@mail.ru